\documentclass[11pt]{article}
\usepackage{
  amsmath,
  amssymb,
  tikz,
  microtype,
  amsthm,
  thmtools,
  stmaryrd,
  hyperref,
  algorithm2e
}


\title{Special topics course: Numerical Polynomial Algebra}
\author{Anand Deopurkar and Markus Hegland}
\date{ANU winter semester 2018}

\newcommand{\C}{\mathbb C}
\newcommand{\Z}{\mathbb Z}
\newcommand{\R}{\mathbb R}
\DeclareMathOperator{\LT}{LT}

\declaretheorem{theorem}
\declaretheorem[sibling=theorem, style=theorem]{proposition}
\declaretheorem[sibling=theorem, style=definition]{definition}
\declaretheorem[sibling=theorem, style=definition]{example}
\declaretheorem[sibling=theorem, style=definition]{problem}

\begin{document}

\maketitle

\section{Algebraic introduction}

\subsection{Ideals}

Let $k$ be a field. Denote by $k[x_1,\dots,x_s]$ the set of polynomials in variables $x_1, \dots, x_s$ with coefficients in $k$. 
Stetter denotes $k[x_1,\dots,x_s]$ by $P^s_k$.
For numerical analysis, we will take $k = \C$, but a lot of the algebraic geometry works best with $k = \C$.
The case of $k = \Z/p\Z$ is used frequently for exact symbolic computation.
Most of the basic algebra is field agnostic.

Let $f_1, \dots, f_k$ be elements of $k[x_1,\dots, x_s]$.
We are interested in solving the system of polynomial equations
\begin{align}\label{eqn:system}
  \begin{split}
  f_1 &= 0,\\
  &\vdots\\
  f_n &= 0.
\end{split}
\end{align}
Our experience with systems of linear equation suggests that we should look at not only the $n$ equations listed above, but also their linear combinations.
This idea suggests the following.
\begin{definition}[Ideal]
  A subset $I$ of $k[x_1, \dots, x_s]$ is called an \emph{ideal} if the following two conditions are satisfies.
  \begin{enumerate}
  \item if $f, g \in I$, then $f+g \in I$
  \item if $f \in I$ and $c \in k[x_1, \dots, x_s]$, then $cf \in I$.
  \end{enumerate}
\end{definition}
The definition of an ideal should be reminiscent of the definition of a subspace of a vector space.
The only difference is that in multipliers in the second condition are not necessarily scalars (elements of $k$) but polynomials.
More succinctly, an ideal is a subset of $k[x_1, \dots, x_s]$ that is closed under polynomial linear combinations.
That is, if $f_1, \dots, f_n \in I$ and $c_1, \dots, c_n \in k[x_1, \dots, x_s]$, then $c_1f_1 + \dots + c_nf_n \in I$.

\begin{example}[The unit ideal]
  The set $I = k[x_1,\dots,x_s]$ is obviously an ideal; it is called the unit ideal.
  Observe that it is the only ideal that contains $1$.
\end{example}

\begin{example}[Ideal generated by a set of polynomials]
  If $f_1, \dots, f_n$ are elements of $k[x_1, \dots, x_s]$, then the set consisting of all polynomial linear combinations of $f_1, \dots, f_s$, namely
  \[ I = \{c_1f_1 + \dots + c_nf_n \mid c_1, \dots, c_n \in k[x_1,\dots,x_s]\}\]
  is an ideal.
  It is the smallest ideal containing $f_1, \dots, f_n$.
  We say that $I$ is \emph{generated by} $f_1, \dots, f_n$, and write
  \[ I = \langle  f_1, \dots, f_n \rangle.\]
\end{example}

A fundamental theorem in commutative algebra is that every ideal has a finite generating set.
\begin{theorem}[Hilbert basis theorem]
  Let $I \subset k[x_1, \dots, x_s]$ be an ideal.
  Then there exists polynomials $f_1, \dots, f_n$ such that $I = \langle  f_1, \dots, f_n \rangle$.
\end{theorem}
There are multiple generating sets for a given ideal, just as there are multiple spanning sets for a subspace of a vector space.
Depending on what we want to do, some generating sets are more useful than others.
A common theme in the course will be to learn how to construct and use good generating sets.

\subsection{Zero loci}
Let $I \subset k[x_1, \dots, x_s]$ be an ideal.
We can associate to $I$ a subset $V(I)$ of $k^s$ called the \emph{zero locus} or the \emph{vanishing locus} of $I$ defined as follows:
\[
  V(I) = \{x \in k^s \mid f(x) = 0 \text{ for all $f \in I$}.\}
\]
Observe that if $I = \langle  f_1, \dots, f_n \rangle$, then $V(I)$ is simply the set of solutions of the system of equations \eqref{eqn:system}.
Thus, solving \eqref{eqn:system} is equivalent to finding $V(I)$.
A subset of $k^s$ of the form $V(I)$ for some ideal $I$ is called an \emph{algebraic subset}.
Some authors also call it an \emph{algebraic variety}, but some other authors reserve the term \emph{variety} only for special types of algebraic sets (namely, the ``irreducible'' ones).

We can turn the construction $I \leadsto V(I)$ around.
Starting with a subset $Z \subset k^s$, we can construct an ideal $I(Z) \subset k[x_1, \dots, x_s]$ as follows:
\[ I(Z) = \{f \in k[x_1,\dots,x_s] \mid f(x) = 0 \text{ for all $x \in Z$}\}.\]
It is easy to check that $I(Z)$ is an ideal.
Furthermore, it is easy to verify that $I(Z)$ is a \emph{radical} ideal.
That is, it satisfies the property that if $f^n \in I(Z)$ for some $n \geq 1$, then $f \in I(Z)$.
(This property is not shared by all ideals.
For example, the ideal $\langle  x^2 \rangle \subset k[x]$ is not radical---it contains $x^2$, but not $x$.)

The following important theorem links the two constructions above.
\begin{theorem}[Nullstellensatz]
  Suppose $k$ is an algebraically closed field (for example, $k = \C$).
  Then we have a one-to-one correspondence
  \[
    \{\text{Radical ideals of $k[x_1,\dots,x_s]$}\}
    \leftrightarrow
    \{\text{Algebraic subsets of $k^s$}\},
  \]
  where the $\rightarrow$  direction is given by $I \mapsto V(I)$ and the $\leftarrow$ direction is given by $I(Z) \mapsfrom I(Z)$.
\end{theorem}

\begin{example}[Failure of the Nullstellensatz for non-closed fields]
  In the Nullstellensatz, it is essential for the base-field to be algebraically closed.
  Take $k = \R$ and $I = \langle  x^2 + 1 \rangle \subset k[x]$.
  Then $I$ is a radical ideal, and we have $V(I) = \emptyset$.
  But we also have $V(\langle  1 \rangle) = \emptyset$.
  So the correspondence is not one-to-one.

  This example shows that when $k$ is ``too small'' (not algebraically closed), then the geometric (right) side may fail to faithfully capture the algebraic (left) side.
  But this happens only because the points on the right hand side that \emph{should} be there are not there because the base-field is too small.
\end{example}

A consequence of the Nullstellensatz is the following dichotomy for systems of polynomial equations.
\begin{theorem}\label{thm:null}
  Consider the system of polynomial equations $f_1 = 0, \dots, f_n = 0$ over an algebraically closed field $k$.
  Then either there exists a solution or there exist polynomials $c_1, \dots, c_n$ such that
  \[ 1 = c_1 f_1 + \dots + c_nf_n.\]
  Equivalently, given an ideal $I$, either $V(I)$ is non-empty, or $I = \langle  1 \rangle$.
\end{theorem}
\begin{proof}
  Suppose $V(I)$ is empty.
  We must prove that $1 \in I$.
  If $I$ is radical, then we have
  \[ V(I) = V(\langle 1 \rangle) = \emptyset.\]
  So by the Nullstellensatz, we have $I = \langle  1 \rangle$, and we are done.

  If $I$ is not radical, then we replace it by its radical $\sqrt I$, defined by
  \[ \sqrt I = \{f \mid f^n \in I \text{ for some $n \geq 1$}\}.\]
  It is straightforward to check (do it!) that $\sqrt I$ is an ideal, is radical, and $V(I) = V(\sqrt I)$.
  From the argument above, we get that $\sqrt I = \langle  1 \rangle$, that is $1 \in \sqrt I$.
  But by definition of $\sqrt I$, this means that $1^n \in I$ for some $n \geq 1$, so $I = \langle  1 \rangle$.
\end{proof}

\subsection{Ideal membership and the division algorithm}
Let us return to the system of polynomial equations
\begin{align}\label{eqn:system1}
  \begin{split}
  f_1 &= 0,\\
  &\vdots\\
  f_n &= 0.
\end{split}
\end{align}
As a first step towards solving this system, we would like to determine whether the system has any solutions at all.
By \autoref{thm:null}, this is equivalent to determining whether $1$ lies in the ideal $\langle  f_1, \dots, f_n \rangle$.
In this section, we will consider a general version of this problem.
\begin{problem}[Ideal membership]
  Given polynomials $f_1, \dots, f_n$ and a polynomial $g$, determine whether $g$ lies in the ideal $\langle  f_1, \dots, f_n \rangle$.
\end{problem}

\subsubsection{The one-variable case}
Suppose $s = 1$ and $n = 1$.
So, we are given a (non-zero) polynomial $f(x)$ and another polynomial $g(x)$.
We want to determine whether $g(x)$ is lies in the ideal $\langle  f(x) \rangle$, that is, whether $g(x)$ is a multiple of $f(x)$.
We simply run the division algorithm!

\begin{algorithm}
  \While{
    $\deg (g) \geq \deg(f)$
  }
  {
    Replace $g$ by $g - \frac{\LT(f)}{\LT(g)} f$, where $\LT$ denotes the leading (highest degree) term.
  }
  Return $g$ as the remainder.
  \bigskip

  \caption{The division algorithm for $g(x) \pmod {f(x)}$}
\end{algorithm}

We have the following key fact.
\begin{proposition}
  The polynomial $g(x)$ lies in $\langle  f(x) \rangle$ if and only if the remainder obtained in the division algorithm for $g(x) \pmod {f(x)}$ is zero.
\end{proposition}

\subsection{The multi-variable case: term orderings}
To extend the division algorithm to more than one variables and ideals generated by more than one polynomial, we must first extend the notion of a leading term.
It turns out that there are multiple ways in which we can reasonably order the monomials in multiple variables.
This gives rise to the idea of a term ordering.

Let $T^s$ be the set of monomials in the variables $\{x_1, \dots, x_s\}$.
We use multi-indices to denote the elements in $T^s$.
For a multi-index $i = (i_1, \dots, i_s)$, the notation $x^i$ means the monomial $x_1^{i_1} \cdots x_s^{i_s}$.
\begin{definition}[Term ordering]
  A \emph{term ordering} is a total ordering $\prec$ on the elements of $T^s$ satisfying the following two properties:
  \begin{enumerate}
  \item if $x^i \prec x^j$ then $x^i \cdot x^k \prec x^j \cdot x^k$ for all multi-indices $k$.
  \item $1 \prec x^i$ for all multi-indices $i$.
  \end{enumerate}
\end{definition}

For $s = 1$, there is only one possible term ordering, namely \[1 \prec x \prec x^2 \prec \cdots.\]
For $s > 1$, however, there are many possibilities.
\begin{example}[Lexicographical ordering]
\end{example}

\begin{example}[Graded lexicographical ordering]
\end{example}

\begin{example}[Weight ordering]
\end{example}

Fix a term ordering $\prec$.
Using $\prec$, we can define the leading term of a polynomial.
For $f \in k[x_1,\dots,x_s]$, let $\LT(f)$, or more precisely $\LT_\prec(f)$, be the term of $f$ with the highest monomial (according to $\prec$).
For example, we have
\begin{align*}
  \LT_{\prec_{\rm lex}} (5x^3y^3-3x^4)  &= -3x^4 \\
  \LT_{\prec_{\rm grlex}} (5x^3y^3-3x^4)  &= 5x^3y^3. 
\end{align*}
We can now generalize the division algorithm as follows.

\begin{algorithm}
  \While{
    there exists an $i$ such that $\LT(f_i)$ divides $\LT(g)$.
  }
  {
    Replace $g$ by $g - \frac{\LT(f_i)}{\LT(g)} f_i$.
  }
  Return $g$ as the remainder.
  \bigskip

  \caption{The division algorithm for $g \pmod {f_1, \dots, f_k}$}
\end{algorithm}



\end{document}